<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.3/css/bulma.min.css">
    <title>Adatok Megjelenítése</title>
    <style>
        img:hover{border: 2px solid crimson;}

    .kepek {
        display: flex;
        flex-wrap: nowrap;
        justify-content: center;
        overflow: scroll;
    }

    .kepek .kep {
        margin: 10px;  
    }

    @media screen and (max-width: 600px) {
        .kepek {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
    }
        .kepek .kep {
            width: 90%;
        }
    }

    </style>
</head>

<body class="has-background-dark has-text-light" style=" min-height: 100vh;">
    <section class="section has-background-dark has-text-light" style=" max-width: 1000px; margin: auto;">
            
            <h1>Stacionaritás (ADF és KPSS) és eloszlás tesztek</h1>
            <div style="overflow-x: auto;">
                <table class="table is-bordered is-striped is-narrow is-hoverable is-fullwidth has-background-light" style="min-width: 100%; overflow-x: scroll;">
                    <thead>
                        <tr>
                            <th rowspan="2"></th>
                            <th colspan="3" class="has-text-centered">ADF teszt</th>
                            <th colspan="3" class="has-text-centered">KPSS teszt</th>
                        </tr>
                        <tr style="font-size: 0.9rem;">
                            <th>Statisztika</th>
                            <th>p-érték</th>
                            <th>Kritikus Érték (5%)</th>
                            <th>Statisztika</th>
                            <th>p-érték</th>
                            <th>Kritikus Érték (5%)</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for idosor in statisztikak %}
                        <tr>
                            <td>{{ idosor.idosor_nev }}</td>

                            <td>{{ idosor.adf.adf_stat }}</td>
                            <td>{{ idosor.adf.p_value }}</td>
                            <td>{{ idosor.adf.critical_values.5 }}</td>

                            <td>{{ idosor.kpss.kpss_stat }}</td>
                            <td>{{ idosor.kpss.p_value }}</td>
                            <td>{{ idosor.kpss.critical_values.5 }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
                
            </div>

            <hr>
             <br>
             <h1 class="subtitle has-text-centered has-text-light">Eloszlás diagramok</h1> <hr>
             <div class="kepek">
                {% for idosor in statisztikak %}
                    <div id="acfpacf" class="has-text-centered">
                        <a target="_blank" href="data:image/png;base64,{{ idosor.distributionPlot }}">
                            <img src="data:image/png;base64,{{ idosor.distributionPlot }}" alt="eloszlás diagram class="kep">
                        </a>
                    </div>
                {% endfor %}
            </div><br>
            
            <table class="table is-bordered is-striped is-narrow is-hoverable is-fullwidth has-background-light" style="min-width: 100%; overflow-x: scroll;">
            <thead>
                
            <tr>
                <th colspan="3" class="has-text-centered">Kolmogorov-Smirnov Teszt a normális eloszlásra</th>
            </tr>
            <tr>
            <th>Idősor</th>
            <th >Statisztika</th>
            <th>p-érték</th>
            </tr>
            </thead>
            
            <tbody>
            {% for idosor in statisztikak %}
            <tr>
            <td>{{ idosor.idosor_nev }}</td>
            <td>{{ idosor.Kolmogorov_Smirnov.statisztika | floatformat:2 }} </td>
            <td>{{ idosor.Kolmogorov_Smirnov.p_value | floatformat:2 }}</td>
            </tr>
            {% endfor %}
            </tbody>
            </table>


            <h1 class="subtitle has-text-centered has-text-light">ACF és PACF tesztek</h1> <hr>
             <div class="kepek">
                {% for idosor in statisztikak %}
                    <div id="acfpacf" class="has-text-centered">
                        <a target="_blank" href="data:image/png;base64,{{ idosor.pacf_acf_Diagram }}">
                            <img src="data:image/png;base64,{{ idosor.pacf_acf_Diagram }}" alt="ACF és PACF teszt" class="kep">
                        </a>
                    </div>
                {% endfor %}
            </div><br>
            <h1 class="subtitle has-text-centered has-text-light">Autokorrelációs diagramok</h1> <hr>
            <div class="kepek">
                {% for idosor in statisztikak %}
                    <div id="acfpacf" class="has-text-centered">
                        <a target="_blank" href="data:image/png;base64,{{ idosor.autocorrelationPlot }}">
                            <img src="data:image/png;base64,{{ idosor.autocorrelationPlot }}" alt="autokorellációs diagram class="kep">
                        </a>
                    </div>
                {% endfor %}
            </div>
        </div>
    </section><hr>

    <section id="arima" style="max-width: 800px; margin: auto; width: 90%;">
        <h1 class="title has-text-centered has-text-light">
            ARIMA modellek beállítása teszteléshez és előrejelzéshez
        </h1>
        <p class="has-text-justified">A fenti ACF és PACF tesztek alapján itt lehet próbálkozni különböző idősor modellekkel.
            A gomb megnyomását követően egy szöveges (txt) fájl kerül letöltésre, amely minden adatsort esetén a modell mutatóit és előrejelzéseit tartalmazza.
        </p>
        <hr>
        <form action="{% url 'arima' %}" method="POST">
            {% csrf_token %}
        {% for idosor in statisztikak %}
            <h3 class="has-text-centered subtitle has-text-light">{{ idosor.idosor_nev }}</h3>
                <label for="{{ idosor.idosor_nev }}_p">p</label>
                <input class="input" type="number" value="2" min="0" required name="{{ idosor.idosor_nev  }}_p" id="{{ idosor.idosor_nev }}_p"> 
                <label for="{{ idosor.idosor_nev }}_d">d </label>
                <input class="input" type="number" value="0" min="0" required name="{{ idosor.idosor_nev  }}_d" id="{{ idosor.idosor_nev }}_d">
                <label for="{{ idosor.idosor_nev }}_q">q</label>
                <input class="input" type="number" value="0" min="0" required name="{{ idosor.idosor_nev  }}_q" id="{{ idosor.idosor_nev }}_q">
                <br><br>
                <div style="display: flex; flex-direction: row; align-items:center; justify-content: space-between;">
                <div>
                    <label for="{{ idosor.idosor_nev }}_ar">AR(p)</label>
                    <input type="radio" checked name="{{ idosor.idosor_nev }}_tipus" id="{{ idosor.idosor_nev }}_ar" value="ar"> &nbsp;&nbsp;&nbsp;
                </div>
                <div>
                    <label for="{{ idosor.idosor_nev }}_ma">MA(q)</label>
                    <input type="radio" name="{{ idosor.idosor_nev }}_tipus" id="{{ idosor.idosor_nev }}_ma" value="ma">&nbsp;&nbsp;&nbsp;
                </div>
                <div>
                    <label for="{{ idosor.idosor_nev }}_arma">ARMA(p, q)</label>
                    <input type="radio" name="{{ idosor.idosor_nev }}_tipus" id="{{ idosor.idosor_nev }}_arma" value="arma">&nbsp;&nbsp;&nbsp;
                </div>
                <div>
                    <label for="{{ idosor.idosor_nev }}_arima">ARIMA(p,d, q)</label>
                    <input type="radio" name="{{ idosor.idosor_nev }}_tipus" id="{{ idosor.idosor_nev }}_arima" value="arima">
                </div>
                </div>
                <label for="{{ idosor.idosor_nev }}_n_pred">Kért előrejelzések száma a tesztadatokon túl</label>
                <input class="input" type="number" value="6" min="0" max="12" name="{{ idosor.idosor_nev }}_n_pred" id="{{ idosor.idosor_nev }}_n_pred">

                <br><br>
        {% endfor %}
            <p>Az előrejelzés az összes beolvasott tesztadat érték száma szerint történik.</p>                
            <input type="submit" class="button is-info" style="width: 100%;" value="ARIMA előrejelzések készítése">
        </form>
        <br><br>
    </section>
</div>


</body>
</html>
